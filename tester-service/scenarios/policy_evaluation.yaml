name: policy_evaluation
description: Validates existing policy evaluation (removed policy creation due to API complexity)
timeout: 60

preconditions:
  - system.healthy == true

actions:
  # Test with existing default policy instead of creating new one
  - type: CHAOS
    system: mysql
    fault: CONNECTION_LOSS
    duration: 30
  
  - type: WAIT
    duration: 10s

expectations:
  # Test default policy behavior
  policies:
    - policy_id: mysql-circuit-open-on-retries
      should_fire: false  # Won't reach 5 retries in 10s
  
  events:
    # Backend emits CONNECTION_ESTABLISHED
    - type: CONNECTION_ESTABLISHED
      count: ">= 1"

validation:
  - default_policies_loaded: true
  - system_recovers: true
